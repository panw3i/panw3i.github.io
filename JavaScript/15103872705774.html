<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
   - 
  
  </title>
 <meta name="description" content="">
 <link href="atom.xml" rel="alternate" title="" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />

    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
    <script src="asset/highlightjs/highlight.pack.js"></script>
    <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
    <script>hljs.initHighlightingOnLoad();</script>
    
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>

<div id="header">
    <h1><a href="index.html"></a></h1>
</div>

</nav>
        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; </span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
      <li><a href="index.html">Home</a></li>
      
        <li class="divider"></li>
        <li><label>DOM</label></li>

          
            <li><a title="阻止事件响应" href="15104674576588.html">阻止事件响应</a></li>
          
            <li><a title="getElementsByTagName 和 querySelectorAll区别" href="15104479265702.html">getElementsByTagName 和 querySelectorAll区别</a></li>
          
            <li><a title="浏览器视口坐标和文档坐标" href="15104140475686.html">浏览器视口坐标和文档坐标</a></li>
          
            <li><a title="DOM书写的坑" href="15102194508282.html">DOM书写的坑</a></li>
          
            <li><a title="DOM表格操作" href="15103790559623.html">DOM表格操作</a></li>
          
            <li><a title="鼠标点击判断左右键和滑轮" href="15101339252456.html">鼠标点击判断左右键和滑轮</a></li>
          
            <li><a title="子节点和兄弟节点获取" href="15102352573741.html">子节点和兄弟节点获取</a></li>
          
            <li><a title="单属性的值只有true和false" href="15101062936522.html">单属性的值只有true和false</a></li>
          
            <li><a title="classList的类属性操作" href="15102199026816.html">classList的类属性操作</a></li>
          
            <li><a title="变量类型前缀" href="15102133953743.html">变量类型前缀</a></li>
          
            <li><a title="节点的常用操作" href="15101390335570.html">节点的常用操作</a></li>
          
            <li><a title="取消a标签的链接跳转" href="15101916215133.html">取消a标签的链接跳转</a></li>
          
            <li><a title="浏览器事件对象兼容性解决" href="15101477921651.html">浏览器事件对象兼容性解决</a></li>
          
            <li><a title="document是所有节点的顶级节点" href="15101470378282.html">document是所有节点的顶级节点</a></li>
          
            <li><a title="input标签反向选择的简写形式" href="15101164766246.html">input标签反向选择的简写形式</a></li>
          

      
        <li class="divider"></li>
        <li><label>JS高级</label></li>

          
            <li><a title="闭包" href="15103199182873.html">闭包</a></li>
          
            <li><a title="JS 使用正则去掉字符串中所有的空格" href="15104105774911.html">JS 使用正则去掉字符串中所有的空格</a></li>
          
            <li><a title="面向对象基础" href="15102922221390.html">面向对象基础</a></li>
          
            <li><a title="this代表的对象" href="15103015888530.html">this代表的对象</a></li>
          
            <li><a title="数组遍历" href="15101945162302.html">数组遍历</a></li>
          
            <li><a title="数组快速排序方法" href="15101914606707.html">数组快速排序方法</a></li>
          
            <li><a title="立即执行函数" href="15100304130796.html">立即执行函数</a></li>
          
            <li><a title="函数的递归调用" href="15101059370680.html">函数的递归调用</a></li>
          
            <li><a title="关于闭包的理解" href="15100279360207.html">关于闭包的理解</a></li>
          

      
        <li class="divider"></li>
        <li><label>JS基础</label></li>

          
            <li><a title="廖雪峰JS笔记" href="15099699704287.html">廖雪峰JS笔记</a></li>
          
            <li><a title="字符串截取的方法" href="15099694090458.html">字符串截取的方法</a></li>
          

      
        <li class="divider"></li>
        <li><label>BOM</label></li>

          
            <li><a title="禁止右键" href="15104605458333.html">禁止右键</a></li>
          
            <li><a title="禁止别人以iframe加载你的页面" href="15104099197123.html">禁止别人以iframe加载你的页面</a></li>
          
            <li><a title="打开并写入内容到新窗口" href="15101459204333.html">打开并写入内容到新窗口</a></li>
          

      
        <li class="divider"></li>
        <li><label>问题总结</label></li>

          
            <li><a title="=== 和 ==" href="15102366517997.html">=== 和 ==</a></li>
          
            <li><a title="png8和png24的根本区别" href="15102170325499.html">png8和png24的根本区别</a></li>
          
            <li><a title=".forEach is not a function问题解决" href="15102026952503.html">.forEach is not a function问题解决</a></li>
          

      
        <li class="divider"></li>
        <li><label>事件</label></li>

          
            <li><a title="事件捕获和冒泡" href="15103987350603.html">事件捕获和冒泡</a></li>
          
            <li><a title="" href="15103872705774.html"></a></li>
          
            <li><a title="事件对象" href="15102410054350.html">事件对象</a></li>
          

      
        <li class="divider"></li>
        <li><label>Cookie</label></li>

          
            <li><a title="cookie" href="15103166032108.html">cookie</a></li>
          

      
      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>

        <section id="main-content" role="main" class="scroll-container">

          <div class="row">
            <div class="large-3 medium-3 columns">
              <div class="hide-for-small">
                <div class="sidebar">
                <nav>
                  <ul id="side-nav" class="side-nav">

                    
                      <li class="side-title"><span>DOM</span></li>
                        
                          <li><a title="阻止事件响应" href="15104674576588.html">阻止事件响应</a></li>
                        
                          <li><a title="getElementsByTagName 和 querySelectorAll区别" href="15104479265702.html">getElementsByTagName 和 querySelectorAll区别</a></li>
                        
                          <li><a title="浏览器视口坐标和文档坐标" href="15104140475686.html">浏览器视口坐标和文档坐标</a></li>
                        
                          <li><a title="DOM书写的坑" href="15102194508282.html">DOM书写的坑</a></li>
                        
                          <li><a title="DOM表格操作" href="15103790559623.html">DOM表格操作</a></li>
                        
                          <li><a title="鼠标点击判断左右键和滑轮" href="15101339252456.html">鼠标点击判断左右键和滑轮</a></li>
                        
                          <li><a title="子节点和兄弟节点获取" href="15102352573741.html">子节点和兄弟节点获取</a></li>
                        
                          <li><a title="单属性的值只有true和false" href="15101062936522.html">单属性的值只有true和false</a></li>
                        
                          <li><a title="classList的类属性操作" href="15102199026816.html">classList的类属性操作</a></li>
                        
                          <li><a title="变量类型前缀" href="15102133953743.html">变量类型前缀</a></li>
                        
                          <li><a title="节点的常用操作" href="15101390335570.html">节点的常用操作</a></li>
                        
                          <li><a title="取消a标签的链接跳转" href="15101916215133.html">取消a标签的链接跳转</a></li>
                        
                          <li><a title="浏览器事件对象兼容性解决" href="15101477921651.html">浏览器事件对象兼容性解决</a></li>
                        
                          <li><a title="document是所有节点的顶级节点" href="15101470378282.html">document是所有节点的顶级节点</a></li>
                        
                          <li><a title="input标签反向选择的简写形式" href="15101164766246.html">input标签反向选择的简写形式</a></li>
                        

                    
                      <li class="side-title"><span>JS高级</span></li>
                        
                          <li><a title="闭包" href="15103199182873.html">闭包</a></li>
                        
                          <li><a title="JS 使用正则去掉字符串中所有的空格" href="15104105774911.html">JS 使用正则去掉字符串中所有的空格</a></li>
                        
                          <li><a title="面向对象基础" href="15102922221390.html">面向对象基础</a></li>
                        
                          <li><a title="this代表的对象" href="15103015888530.html">this代表的对象</a></li>
                        
                          <li><a title="数组遍历" href="15101945162302.html">数组遍历</a></li>
                        
                          <li><a title="数组快速排序方法" href="15101914606707.html">数组快速排序方法</a></li>
                        
                          <li><a title="立即执行函数" href="15100304130796.html">立即执行函数</a></li>
                        
                          <li><a title="函数的递归调用" href="15101059370680.html">函数的递归调用</a></li>
                        
                          <li><a title="关于闭包的理解" href="15100279360207.html">关于闭包的理解</a></li>
                        

                    
                      <li class="side-title"><span>JS基础</span></li>
                        
                          <li><a title="廖雪峰JS笔记" href="15099699704287.html">廖雪峰JS笔记</a></li>
                        
                          <li><a title="字符串截取的方法" href="15099694090458.html">字符串截取的方法</a></li>
                        

                    
                      <li class="side-title"><span>BOM</span></li>
                        
                          <li><a title="禁止右键" href="15104605458333.html">禁止右键</a></li>
                        
                          <li><a title="禁止别人以iframe加载你的页面" href="15104099197123.html">禁止别人以iframe加载你的页面</a></li>
                        
                          <li><a title="打开并写入内容到新窗口" href="15101459204333.html">打开并写入内容到新窗口</a></li>
                        

                    
                      <li class="side-title"><span>问题总结</span></li>
                        
                          <li><a title="=== 和 ==" href="15102366517997.html">=== 和 ==</a></li>
                        
                          <li><a title="png8和png24的根本区别" href="15102170325499.html">png8和png24的根本区别</a></li>
                        
                          <li><a title=".forEach is not a function问题解决" href="15102026952503.html">.forEach is not a function问题解决</a></li>
                        

                    
                      <li class="side-title"><span>事件</span></li>
                        
                          <li><a title="事件捕获和冒泡" href="15103987350603.html">事件捕获和冒泡</a></li>
                        
                          <li><a title="" href="15103872705774.html"></a></li>
                        
                          <li><a title="事件对象" href="15102410054350.html">事件对象</a></li>
                        

                    
                      <li class="side-title"><span>Cookie</span></li>
                        
                          <li><a title="cookie" href="15103166032108.html">cookie</a></li>
                        

                    
                  </ul>
                </nav>
                </div>
              </div>
            </div>
            <div class="large-9 medium-9 columns">

 <div class="markdown-body">
<h1></h1>

<p>首页所有文章JavaScriptHTML5CSS基础技术职场工具资源前端小组更多频道▼<br/>
伯乐在线 &gt; WEB前端 - 伯乐在线 &gt; 所有文章 &gt; JavaScript &gt; 又被事件冒泡坑了一把，这次要彻底弄懂浏览器的事件流<br/>
又被事件冒泡坑了一把，这次要彻底弄懂浏览器的事件流</p>

<p>2016/06/27 · JavaScript · 1 评论 · 事件冒泡, 事件捕获, 事件流, 浏览器<br/>
分享到： 2<br/>
本文作者： 伯乐在线 - 昱见 。未经作者许可，禁止转载！<br/>
欢迎加入伯乐在线 专栏作者。<br/>
打算封装一个弹窗组件，做的时候忘记了考虑事件冒泡的因素，结果被坑得不要不要的。为了解决自己的问题，去查阅了不少资料，把事件流相关的知识都给总结一下。</p>

<p>事件冒泡：一个简单，但是坑了我无数回的知识点！</p>

<p>JavaScript与HTML的交互通过事件来实现。而浏览器的事件流是一个非常重要的概念。不去讨论那些古老的浏览器有事件捕获与事件冒泡的争议，只需要知道在DOM2中规定的事件流包括了三个部分，事件捕获阶段、处于目标阶段、事件冒泡阶段。</p>

<p>一、事件捕获</p>

<p>事件捕获，是从document元素开始，越高级的父级元素越早接收到事件，因此这是一个从上而下的过程。</p>

<p>还是那句话，没在实际应用中踩过坑，可能你真的不算掌握了这个知识点。那么，事件捕获有什么常见的坑呢？</p>

<ol>
<li>坑一：新插入的子元素没有绑定点击事件</li>
</ol>

<p>可能不少同学在初学js的时候遇到过这样一个坑。一个ul元素中初始的状态有4个li元素，我们可以循环给li元素添加click事件，执行我们想要的动作。这个例子的坑就在于，新添加的li元素不会有我们绑定的click事件。</p>

<p>JavaScript</p>

<ul class="container">

    <!-- 先循环给原有的4个li绑定click事件 -->
    <li class="item"></li>
    <li class="item"></li>
    <li class="item"></li>
    <li class="item"></li>
    
    <!-- 这是新添加的li元素，但是该元素没绑定click事件 -->
    <li class="item new"></li>
</ul>

<p>1<br/>
2<br/>
3<br/>
4<br/>
5<br/>
6<br/>
7<br/>
8<br/>
9<br/>
10<br/>
11<br/>
<ul class="container"></p>

<pre><code>&lt;!-- 先循环给原有的4个li绑定click事件 --&gt;
&lt;li class=&quot;item&quot;&gt;&lt;/li&gt;
&lt;li class=&quot;item&quot;&gt;&lt;/li&gt;
&lt;li class=&quot;item&quot;&gt;&lt;/li&gt;
&lt;li class=&quot;item&quot;&gt;&lt;/li&gt;

&lt;!-- 这是新添加的li元素，但是该元素没绑定click事件 --&gt;
&lt;li class=&quot;item new&quot;&gt;&lt;/li&gt;
</code></pre>

<p></ul><br/>
是的，就是这么坑，为了解决这个问题，我们就要利用事件捕获的原理。</p>

<p>JavaScript</p>

<p>\((&#39;ul.container&#39;).click(function(event) {<br/>
    var target = event.target;<br/>
    if (target.className == &#39;item&#39;) {<br/>
        // dosomething<br/>
    }<br/>
})<br/>
1<br/>
2<br/>
3<br/>
4<br/>
5<br/>
6<br/>
\)(&#39;ul.container&#39;).click(function(event) {<br/>
    var target = event.target;<br/>
    if (target.className == &#39;item&#39;) {<br/>
        // dosomething<br/>
    }<br/>
})<br/>
在上面的解决方案中，我并不是直接给li绑定事件，而是给所有li的父级ul绑定事件。根据事件捕获的原理，事件会自上而下传递给li，我们只需要通过一些简单的条件判断来确定我们的目标元素即可，如上例中的判断li的className。</p>

<p>这个方式就是大名鼎鼎的事件委托。</p>

<p>事件委托是一个很重要而且在实际中会常常用到的知识点。</p>

<ol>
<li>坑二： 如果目标元素有子元素，那么怎么办？</li>
</ol>

<p>当我们在使用className判断目标元素时，会遇到这样的情况。</p>

<p>JavaScript</p>

<p>...<br/>
<li class="item"><br/>
    <div class="title">xxx</div><br/>
    <p class="desc">xxxxxxs</p><br/>
</li><br/>
...<br/>
1<br/>
2<br/>
3<br/>
4<br/>
5<br/>
6<br/>
...<br/>
<li class="item"><br/>
    <div class="title">xxx</div><br/>
    <p class="desc">xxxxxxs</p><br/>
</li><br/>
...<br/>
当我们试图使用事件委托希望给所有的li添加元素时，在利用className判断的过程中发现，目标event.target元素居然是li.item的子元素，这个时候就没办法准确的将事件绑定到li上了，这个时候我们应该怎么办？</p>

<p>这种情况，我们要做的，就是阻止事件捕获的传递，那么，要如何阻止呢？</p>

<p>我知道的一种方式，利用css，给li所有子元素添加如下css属性即可</p>

<p>JavaScript</p>

<p>li.item &gt;  * {<br/>
  pointer-events: none;<br/>
}<br/>
1<br/>
2<br/>
3<br/>
li.item &gt;  * {<br/>
  pointer-events: none;<br/>
}<br/>
按道理来说，应该是有js方式的，可是查了很多文章都没有提及，因此就暂时这样吧，到时候遇到了在补充。<br/>
在jquery中，已经帮助我们实现了事件委托，并且帮我们解决掉了这些坑。我们只需要按照一定语法使用即可，而我们不用再自己去进行条件判断，比如我们要给所有的li.item元素绑定事件，写法如下</p>

<p>JavaScript</p>

<p>// on中的第二参数就是我们的目标元素的选择器<br/>
\((&#39;ul.container&#39;).on(&#39;click&#39;, &#39;li.item&#39;, function(event) {<br/>
    // dosomething<br/>
})<br/>
1<br/>
2<br/>
3<br/>
4<br/>
// on中的第二参数就是我们的目标元素的选择器<br/>
\)(&#39;ul.container&#39;).on(&#39;click&#39;, &#39;li.item&#39;, function(event) {<br/>
    // dosomething<br/>
})<br/>
二、事件冒泡</p>

<p>说完了事件捕获，然后来说说事件冒泡这个坑。所谓事件冒泡，就是让DOM树最底层的目标元素最先接收到事件，然后往上传递，这是一个自下而上的过程。</p>

<p>我们常常会遇到一种弹窗样式，弹窗出来时，内容在中间，然后会有一层半透明的遮罩将页面内容与弹窗区分开。弹窗内容会有一些按钮绑定点击事件，比如确认与取消。而在半透明遮罩上，可能也会绑定一个点击事件，当点击时，将弹窗隐藏。如果我由于经验不足，将该遮罩层设置成了弹窗按钮的父级，那么就会遇到事件冒泡带来的麻烦。</p>

<p>也就是说，在如下例子中 container是全屏遮罩，button是弹窗里面的点击按钮。他们都同时绑定了click事件，执行不同的动作。但是在实际执行的时候，当我点击了button，那么button和container的click事件都会执行，自下而上按顺序执行</p>

<p>JavaScript</p>

<div className="container">
    <div className="button">click</div>

<p></div><br/>
1<br/>
2<br/>
3<br/>
<div className="container"><br/>
    <div className="button">click</div><br/>
</div><br/>
我为这个事情写了一个小例子，大家可以动手感受一下这个坑。点击空白会生成一个弹窗</p>

<p><a href="http://yangbo5207.github.io/static/demo/event-flow/dev/">http://yangbo5207.github.io/static/demo/event-flow/dev/</a></p>

<p>好吧解决问题的方法很简单，就是阻止冒泡事件。</p>

<p>JavaScript</p>

<p>$xxx.click(function(e) {<br/>
    e.stopPropagation();</p>

<pre><code>// ie
e.cancelBubble = true;
</code></pre>

<p>})<br/>
1<br/>
2<br/>
3<br/>
4<br/>
5<br/>
6<br/>
$xxx.click(function(e) {<br/>
    e.stopPropagation();</p>

<pre><code>// ie
e.cancelBubble = true;
</code></pre>

<p>})<br/>
理解了整个事件流，我们可以感受事件在DOM中的传递过程与方向，并且利用他来解决我们的问题和各种坑，虽然是一个简单的知识点，但是却非常容易被忽略，因此建议大家找机会将它掌握牢固。</p>

<p>而还有一个坑，可能大家在实际中会很少遇到，这个坑就是，某些事件类型天生就不支持事件冒泡！</p>

<p>blur: 在元素失去焦点时触发，该事件不支持冒泡<br/>
focus: 在元素获得焦点时触发，该事件不支持冒泡<br/>
mouseenter: 当鼠标移入元素时触发，该事件不支持冒泡<br/>
mouseleave: 当鼠标移出元素时触发，该事件不支持冒泡<br/>
… …</p>

<p>以及IE6 IE7 IE8中 的 change、select、submit、reset 事件事实上都没有参照规范定义产生事件冒泡。</p>

<p>当你在需要的冒泡的时候，绑定了这些事件，而你恰好不知道居然还有事件天生就不支持冒泡的，那么你可能就悲剧了。所以这个点只要在脑袋里面有个印象就好了，我只记得我曾经遇到过这样一个坑，但暂时想不起来应用场景了 – -！</p>

<p>我所知道的，遇到过的关于事件流的坑就这么多了，想来应该也算是非常完整的一个总结了，值得大家点一下推荐和收藏的哦！</p>


</div>

<br /><br />
<hr />

<div class="row clearfix">
  <div class="large-6 columns">
	<div class="text-left" style="padding:15px 0px;">
		
	        <a href="15103987350603.html"  title="Previous Post: 事件捕获和冒泡">&laquo; 事件捕获和冒泡</a>
	    
	</div>
  </div>
  <div class="large-6 columns">
	<div class="text-right" style="padding:15px 0px;">
		
	        <a href="15102194508282.html" 
	        title="Next Post: DOM书写的坑">DOM书写的坑 &raquo;</a>
	    
	</div>
  </div>
</div>

<div class="row">
<div style="padding:0px 0.93em;" class="share-comments">

</div>
</div>
<script type="text/javascript">
	$(function(){
		var currentURL = '15103872705774.html';
		$('#side-nav a').each(function(){
			if($(this).attr('href') == currentURL){
				$(this).parent().addClass('active');
			}
		});
	});
</script>  
</div></div>


<div class="page-bottom">
  <div class="row">
  <hr />
  <div class="small-9 columns">
  <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
  <div class="small-3 columns">
  <p class="copyright text-right"><a href="#header">TOP</a></p>
  </div>
   
  </div>
</div>

        </section>
      </div>
    </div>
    
    
    <script src="asset/js/foundation.min.js"></script>
    <script src="asset/js/foundation/foundation.offcanvas.js"></script>
    <script>
      $(document).foundation();

     
    </script>
    


  </body>
</html>
